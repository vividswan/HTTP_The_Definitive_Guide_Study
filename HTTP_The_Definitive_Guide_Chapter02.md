# 2장 - URL과 리소스

- `URL(Uniform Resource Location)`은 인터넷의 리소스를 가리키는 표준 이름
  - 리소스는 텍스트, 이미지, 동영상 등등
  - URL은 전자정보 일부를 가리키고 그것이 어디에 있고 어떻게 접근할 수 있는지 알려줌
- 2장에서 다루는 내용
  - URL 문법 & 여러 URL 컴포넌트의 의미, 수행하는 일
  - 단축 URL(상대 URL, 확장 URL)
  - URL 인코딩, 문자 규칙
  - 여러 인터넷 정보 시스템에 적용되는 공통 URL 스킴
  - URN을 포함한 URL의 미래

## 2.1 인터넷 리소스 탐색하기

- URL로 리소스의 위치를 찾고, 사용하며 공유할 수 있음
- HTTP 및 다른 프로토콜을 통해 접근 가능
- URL은 URI(Uniform Resource Identifier)의 부분집합
  - URI는 URL과 URN으로 구성된 종합적인 개념
  - URN은 리소스가 어디든 그 이름만으로 리소스를 식별
- http://www.joes-hardware.com/seasonal/index-fall.html 예제
  - 첫 부분인 http는 URL의 스킴
  - 두 번째 부분(www.joes-hardware.com)은 서버의 위치
  - 세 번째 부분(/seasonal/index-fall.html)은 리소스의 경로
- URL은 HTTP 프로토콜 외에 다른 가용한 프로토콜 사용 가능
  - 대부분은 `스킴://서버위치/경로` 구조

### 2.1.1 URL이 있기 전 암흑의 시대

- 일관된 방식이 없었음
- URL은 애플리케이션이 리소스에 접근할 수 있는 방법을 제공
  - 많은 사람들이 프로토콜과 접근 방식이 무엇인지 모르고도 사용

## 2.2 URL 문법

- 리소스들은 다른 스킴을 통해 접근 가능
  - 서로 다른 URL 스킴도 형태와 문법 면에서 매우 유사
- URL 스킴의 문법은 9개 부분으로 나뉨 (가장 중요한 것은 스킴, 호스트, 경로)
  - 스킴 : 어떤 프로토콜을 이용하는지
  - 사용자 이름 : 리소스에 접근하기 위해 사용자 이름이 필요할 때
  - 비밀번호 : 사용자의 비밀번호를 가리킴
  - 호스트 : 리소스를 호스팅 하는 서버의 호스트 명이나 IP 주소
  - 포트 : 리소스를 호스팅 하는 서버가 열어놓은 포트 번호
  - 경로 : 서버 내 리소스가 서버 어디에 있는지 알려줌, 빗금(/)으로 구분
  - 파라미터 : 특정 스킴들에서 입력 파라미터를 기술하는 용도
  - 질의 : 스킴에서 애플리케이션에 파라미터를 전달하는데 쓰임
  - 프래그먼트 : 리소스의 조각이나 일부를 가리킴, 서버에 전달되지 않음

### 2.2.1 스킴: 사용한 프로토콜

- 어떤 프로토콜을 사용하여 리소스를 요청해야 하는지 알려줌
- 알파벳으로 시작, URL의 나머지 부분들과 첫 번째 ':' 문자로 구분
- 스킴명은 대소문자를 가리지 않음

### 2.2.2 호스트와 포트

- 호스트 컴포넌트는 접근하려고 하는 리소스를 가지고 있는 인터넷상의 호스트 장비를 가리킴
- 포트 컴포넌트는 서버가 열어놓은 네트워크 포트를 가리킴
  - TCP 프로토콜을 사용하는 HTTP는 기본 포트로 80 사용

### 2.2.3 사용자 이름과 비밀번호

- 많은 서버는 자신의 데이터에 접근을 허용하기 위해 사용자 이름과 비밀번호를 요구
  - FTP와 같은 프로토콜에서 사용
  - 기술하지 않는다면 기본값 사용

### 2.2.4 경로

- 경로 컴포넌트는 리소스가 서버의 어디에 있는지 알려줌
  - 계층적 파일 시스템 경로와 유사한 구조
- '/' 문자를 기준으로 경로 조각으로 나뉨
  - 경로 조각은 자체만의 파라미터 컴포넌트를 가질 수 있음

### 2.2.5 파라미터

- URL 파라미터 컴포넌트는 애플리케이션이 서버에 정확한 요청을 하기 위해 필요한 입력 파라미터를 받는데 사용
- 이름/값 쌍의 리스트, URL의 나머지 부분들로부터 ';' 문자로 구분하여 URL에 기술
- 경로 컴포넌트의 각 조각은 자체 파라미터를 가질 수 있음

### 2.2.6 질의 문자열

- 요청받을 리소스 형식의 범위를 좁히기 위해서 질문이나 질의를 받을 수 있음
- 물음표(?)의 우측에 있는 값들을 질의 컴포넌트라고 부름
- '&'로 나뉜 '이름=값' 쌍 형식의 질의 문자열을 사용

### 2.2.7 프래그먼트

- 리소스 내의 특정 부분을 가리킬 수 있도록 프래그먼트 컴포넌트를 사용
- URL의 오른쪽에 '#' 문자에 이어서 나옴
- 클라이언트는 서버에 프래그먼트를 전달하지 않고 브라우저가 서버로부터 전체 리소스를 내려받은 후 프레그먼트를 사용하여 리소스의 일부를 보여줌

## 2.3 단축 URL

### 2.3.1 상대 URL

- URL은 상대 URL과 절대 URL 두 가지로 나뉨
  - 절대 URL은 리소스에 필요한 모든 정보를 가지고 있음
  - 상대 URL은 모든 정보를 담고 있지는 않다.
- 상대 URL로 리소스에 접근하는데 필요한 모든 정보를 얻기 위해서는 기저(base)라고 하는 다른 URL를 사용해야 함
- 상대 URL 문법에서는 URL에 스킴, 호스트, 다른 컴포넌트 등을 모두 입력하지 않아도 됨
  - 기저 URL에서 그 정보를 알아낼 수 있다.
- 기저 URL
  - 변환의 첫 단계에서 기저 URL을 찾아옴
  - 기저 URL은 상대 URL의 기준
  - 가져오는 몇 가지 방법이 존재 (리소스에서 명시적 제공, 리소를 포함하고 있는 기저 URL, 기저 URL이 없는 경우도 존재)
- 상대 참조 해석하기
  - 상대 URL을 절대 URL로 변환하기 위해선 상대 URL과 기저 URL을 각각의 컴포넌트 조각으로 나눔
  - 분해 후 변환을 하는 알고리즘을 사용 (RFC 2396에 포함)

### 2.3.2 URL 확장

- 자동으로 URL이 확장되는 '확장' 기능은 두 가지로 나뉨
- 호스트명 확장
  - 휴리스틱만을 이용해서 입력한 호스트 명을 전체 호스트 명으로 확장
  - ex) 'yahoo'를 입력하면 'www'와 '.com'을 붙여줌
  - 시간 절약과 혼란을 막아주지만 프락시와 같은 다른 HTTP 애플리케이션에 문제를 발생시킬 수도 있음
- 히스토리 확장
  - 과거에 사용자가 방문했던 URL의 기록을 저장
  - 프락시를 사용할 경우 URL 자동확장 기능은 다르게 동작할 수 있음

## 2.4 안전하지 않은 문자

- 안전한 전송 : 정보가 유실될 위험 없이 URL을 전송할 수 있다는 것
- URL에선 출력이 되지 않거나 보이지 않는 문자를 사용하는 것이 금지되었음
- 이진 데이터나 알파벳 외의 문자도 포함하기 위해 이스케이프 기능을 추가

### 2.4.1 URL 문자 집합

- 컴퓨터 시스템의 기본 문자 집합은 US-ASCII 문자 집합을 사용해왔음
- URL이 특정 이진 데이터를 포함하는 일등을 지원하기 위해 URL에 이스케이프 문자열을 쓸 수 있게 설계
  - 특정 문자나 데이터를 인코딩할 수 있게 함으로써 이동성과 완성도를 높임

### 2.4.2 인코딩 체계

- 인코딩은 안전하지 않은 문자를 퍼센티지 기호(%)로 시작해 ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 이스케이프 문자로 바꿈

### 2.4.3 문자 제한

- URL 내에서 특별한 의미로 예약되어 있는 문자들이 있음
- 어떤 문자는 몇몇 인터넷 게이트웨이와 프로토콜에서 혼동을 일으킴
- 예약된 문자들을 본래의 목적이 아닌 다른 용도로 사용하려면 그전에 반드시 인코딩해야 함

### 2.4.4 좀 더 알아보기

- 애플리케이션은 정해진 방식대로 구현해야 함
  - URL을 보내기 전 클라이언트 애플리케이션에서 안전하지 않거나 제한된 문자는 변환하는 것이 좋음
  - 최초로 URL을 입력받는 애플리케이션에서 인코딩하는 것이 가장 적절
  - 극단적인 방법은 애플리케이션이 모든 문자를 인코딩 (추천 X, 오작동을 일으킬 수 있음)

## 2.5 스킴의 바다

- http : 일반 URL 포맷을 지키는 하이퍼텍스트 전송 프로토콜, 포트 기본값은 80
- https : http 스킴과 거의 같으며 HTTP 커넥션의 양 끝단에서 암호화하기 위해 `보안 소켓 계층(Secure Sockets Layer, SSL)`을 사용
- malito : malito URL은 이메일 주소를 가리킴, 표준 URL 과는 다른 포맷을 가짐(RFC 822에 기술)
- ftp : 파일 전송 프로토콜, FTP 서버에 있는 파일을 내려받거나 올릴 수 있음
- rtsp, rtspu : RTSP URL은 실시간 스트리밍 프로토콜, rstpu의 경우엔 리소스를 읽기 위해 UDP 프로토콜이 사용됨
- file : 주어진 호스트 기기(로컬 디스크, 네트워크 파일 시스템 등등)에서 바로 접근할 수 있는 파일들을 나타냄
- news : 특정 문서나 뉴스 그룹에 접근하는 데 사용, 리소스의 위치 정보를 충분히 포함하지 않는 특이한 속성
- telnet : 대화형 서비스에 접근하는 데 사용, telnet 프로토콜을 통해 대화용 애플리케이션에 접근 가능

## 2.6 미래

- URL이 완벽한 것은 아님
  - URL은 주소일 뿐 실제 이름은 X
  - 리소스가 옮겨지면 더는 사용 불가능
- 객체의 위치와 상관없이 실제 객체의 이름을 이용하는 URN 존재
- 지속 통합 자원 지시자(Persistent uniform resource locators, PURL)을 사용하면 URL로 URN의 기능 제공 가능
  - 리소스 위치 중개 서버로 리소스를 우회적으로 제공

### 2.6.1 지금이 아니면, 언제?

- URL에서 URN으로 주소 체계를 바꾸는 것은 매우 큰 작업
  - 당분간 URL이 사용될 것
- URL은 현재는 물론 가까운 미래에도 인터넷에 있는 리소스를 명명하는 방법이 될 것
  - 다만 URL의 한계가 있는 상태에서 그것을 해결할 수 있는 새로운 표준 같은 것들이 나오고 적용될 것
